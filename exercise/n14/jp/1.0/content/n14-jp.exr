問題

適応型素数判定法とは、自然数 $n \in \mathbb{N}$ が素数かどうかを判定する際に、確率的手法と決定論的手法を段階的に選択するアルゴリズムです。例としては、Miller-Rabin法、Baillie-PSW法、AKS法などが挙げられます。

以下の特性を持つ適応型素数判定法を開発し、解析してください。

- アルゴリズムは確率的検定（例:Miller-Rabin法）から開始します。
- この検定に複数回合格した場合、システムは境界条件において決定論的サブ検定（例:Lucas法、ECPP法、または簡約AKSレベル）を実行します。
- 手法の全体的な複雑さは、$n$ のサイズと想定される誤り確率 $\varepsilon$ に依存します。

課題:これらの手法の漸近的に最適な組み合わせ（証明付き）を見つけ、ランダムに選択された数 $n \in [1, N]$ の現実的な分布を仮定し、「素数」と「素数でない」の判定にかかる最小の期待実行時間を計算してください。

**目標:**

- **誤差制御適応的複雑性** モデルを解析してください。
- 最適な手法の実行時間（期待値）を記述する関数クラス $T(n, \varepsilon)$ を開発してください。
- 作成した解を、Miller-Rabin（多重）、Baillie-PSW、決定論的AKSなどのよく知られた手法と比較してください。